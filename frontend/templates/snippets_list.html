{% for result in result_set.results %}
  <div class='snippet {% cycle row_highlight,row_plain %}'>
    <table>
    <tr>
    <td valign='top'>
    <div class='snippet_buttons'>
      <div class='snippet_button'
           onclick='expressInterest(this, "{{result.id|escape}}",
                                          "{{result.base_url|escape}}",
                                          "{{result.interest|escape}}")'>
        {% if result.interest %}
          <img src='images/Event-Selected-Star.png' alt=''/>
        {% else %}
          <img src='images/Event-UnSelected-Star.png' alt=''/>
        {% endif %}
      </div>

      <!-- TODO(doll): Add to calendar functions need dates in the right format -->
      <div class='snippet_button'
           onclick='addToCalendar(this, "YAHOO", "{{result.url|escape}}",
                                  "{{result.js_escaped_title|escape}}",
                                  "{{result.js_escaped_snippet|escape}}",
                                  "20090214", "{{result.location}}")'>
        <img src='images/Event-AddToCalendar.png' height="16px" alt='Yahoo! Calendar'/>
      </div>
      <div class='snippet_button'
           onclick='addToCalendar(this, "GOOGLE", "{{result.url|escape}}",
                                  "{{result.js_escaped_title|escape}}",
                                  "{{result.js_escaped_snippet|escape}}",
                                  "20090214", "{{result.location}}")'>
        <img src='images/Event-AddToCalendar.png' height="16px" alt='Google Calendar'/>
      </div>
      <div class='snippet_button'>
        <script type="text/javascript">
        SHARETHIS.addEntry({
            url: "{{result.url|escape}}",
            title: "{{result.js_escaped_title|escape}}",
            summary: "{{result.js_escaped_snippet|escape}}"
        }, {offsetLeft: 0});
        </script>
      </div>

    </div>
    </td>
    <td valign='top'>
    <div>
      {# TODO(paul): ESCAPE THE LOCATION FIELD AGAINST QUOTES #}
      {% if location %}
        <script>asyncLoadManager.addCallback('map', function(){
            map.addMarkerGeocode("{{ result.location }}")});</script>
      {% endif %}

      <div class='snippet_title'>
        <a href='{{ result.url }}'>{{ result.title }}</a>
      </div>
      {% if location or result.interest_count %}
        <div class='snippet_sub_text'>
          {{ result.location }}
          {% if result.interest_count %}
            {% if location %}-{% endif %}
            <img src="images/Event-StarredByOthers.png" alt="Starred"/> by {{result.interest_count}}
            {% ifequal result.interest_count 1 %} person {% else %} people {% endifequal %}
          {% endif %}
        </div>
      {% endif %}
      <div class='snippet_text'>
        {{ result.snippet }}
      </div>
      <div class='snippet_url'>
        <a href='{{ result.url }}'>{{ result.url_short }}</a>
      </div>

    </div>
    </td>
    </tr>
    </table>
  </div>
{% endfor %}
